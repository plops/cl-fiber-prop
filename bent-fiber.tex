
\documentclass[DIV19,twocolumn]{scrartcl}

%\includeonly{spatio-angular}

%\usepackage{enumitem}
%\setitemize{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}

%\usepackage{etoolbox}

\pdfminorversion=5
% 9 is best zlib compression i use 0 while writing in the hope that
% git can track changes more easily, set 0 0
\pdfcompresslevel=9
% 3 is maximum for now
\pdfobjcompresslevel=3


\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[usenames,dvipsnames]{color}
%\usepackage[onehalfspacing]{setspace} 
%\usepackage[draft]{graphicx}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{soul}
\usepackage{amssymb}
\usepackage{amsmath}
%\usepackage{examplep}
%\usepackage{pdfcomment}  % breaks hyperref metadata

% choose font here: http://www.tug.dk/FontCatalogue/mathfonts.html
\usepackage[T1]{fontenc}
%\usepackage[math]{iwona}
\usepackage[math]{kurier}
%\usepackage{cmbright}
\usepackage[scaled]{beramono}

\usepackage{footnote}

\usepackage{microtype}
\newcommand\Small{\fontsize{9}{9.2}\selectfont}
\newcommand*\LSTfont{\Small\ttfamily\SetTracking{encoding=*}{-60}\lsstyle}
\newcommand*\cmafont{\fontsize{8}{8.2}\selectfont\ttfamily\SetTracking{encoding=*}{-60}\lsstyle}


\usepackage{esvect} % vector CB in raytrace chapter



%\newcont\pdfcompresslevel


%\usepackage[hypertex,breaklinks]{hyperref} 
% breaklinks only seems to work with dvipdfm,
% otherwise urls have no
% line breaks

%\usepackage[showrefs,showcites,ignoreunlbld]{refcheck} % for draft, uncomment for final
%\usepackage[notref,notcite]{showkeys}

\usepackage[disable]{todonotes} % for draft, disable for final

\usepackage{lineno}
\usepackage[refpage]{nomencl}
%\special{background Black}\special{color Green}
%\usepackage[utf8x]{inputenc} 
%\usepackage[T2A]{fontenc} % for the russian reference
\usepackage{wasysym} %diameter
% http://www.andy-roberts.net/misc/latex/latextutorial3.html

%\usepackage{url} % natbib.pdf p.11 break urls up, seems to be done
                 % with hyperref, though

\usepackage{natbib}

\usepackage[pdftex,a4paper=true,plainpages,bookmarksnumbered,pagebackref,% put after natbib
pdftitle={Light propagation through bent multi-mode fibers},%
pdfauthor={Martin Kielhorn},%
pdfkeywords={optical fibers, mode coupling}, %
pdfsubject={Technical Report}]{hyperref}


\usepackage{siunitx} %sudo apt-get install texlive-science
\usepackage{units}


% for app_hilo
\usepackage{listings}
\usepackage{color}
\usepackage{textcomp}
\usepackage{subfigure}


% \listfiles % show which files are loaded by tex

\bibpunct{(}{)}{;}{a}{}{,}
\makenomenclature
\newcommand{\vect}[1]{\mathbf{#1}}
\renewcommand{\r}{\vect r}
\renewcommand{\a}{\vect a}
\newcommand{\s}{\vect s}
\newcommand{\vnu}{\mbox{\boldmath{$\nu$}}}
\newcommand{\vmu}{\mbox{\boldmath{$\mu$}}}
\newcommand{\vtau}{\mbox{\boldmath{$\tau$}}}
\newcommand{\vrho}{\mbox{\boldmath{$\rho$}}}
\newcommand{\vvarrho}{\mbox{\boldmath{$\varrho$}}}
\newcommand{\supp}{\mathop{\mathrm{supp}}}
\newcommand{\pois}{\mathop{\mathrm{pois}}}
\newcommand{\step}{\mathop{\mathrm{step}}}
\newcommand{\diag}{\mathop{\mathrm{diag}}}
\def\k{\vect k}
\def\d{\vect d}
\def\e{\vect e}
\def\E{\vect E}
\def\f{\vect f}
\def\H{\vect H}
\def\c{\vect c}
\def\x{\vect x}
\def\y{\vect y}
\def\z{\vect z}
\def\q{\vect q}
\def\vzeta{\vect \zeta}
\def\p{\vect p}
\def\P{\vect P}
\def\l{\vect l}

\newcommand{\nvect}[1]{\vect{\widehat{#1}}}
%\renewcommand{\i}{\nvect i}
\newcommand{\vi}{\nvect \i}
\def\hc{\nvect c}
\def\hs{\nvect s}
\def\hd{\nvect d}
\def\hx{\nvect x}
\def\hy{\nvect y}

\def\hz{\nvect z}
\def\n{\widehat{\vect n}}
\def\t{\nvect t}
\def\m{\nvect m}
\def\vrho{\boldsymbol\rho}
\def\abs#1{\mathopen| #1 \mathclose|}
\def\({\left(}
\def\){\right)}

\newcommand{\nco}{n_\textrm{co}}
\newcommand{\rco}{r_\textrm{co}}
\newcommand{\neff}{n_\textrm{eff}}
\newcommand{\ncl}{n_\textrm{cl}}
\newcommand{\lmax}{l_\textrm{max}}
\newcommand{\mmax}{m_\textrm{max}}
\newcommand{\umax}{u_\textrm{max}}
\newcommand{\umin}{u_\textrm{min}}
\newcommand{\Ainfty}{A_\infty}

\renewcommand{\O}{\textsf{O}} % oxygen

% conclusions of paragraphs in the margin
%\usepackage[marginparwidth=2.5cm]{geometry}
\setlength{\marginparwidth}{2.2\marginparwidth}
\reversemarginpar
\newcommand{\cma}[1]{\marginpar{\cmafont{#1}}}
% include eps or pdf file, that was generated by inkscape, depending
% on if pdflatex or latex processes this file. latex allows a faster
% development cycle but pdflatex generates a smaller and better final
% pdf output
\def\svgending{\ifx\pdfoutput\undefined% 
  .eps_tex% 
  \else%
  .pdf_tex%
  \fi}

% use \svginput{1}{bla} to include bla.svg, make sure you keep this in
% one line, so that make can automatically find the dependencies with
% sed
\newcommand{\svginput}[2]{{\def\svgscale{#1}\input{#2\svgending}}}

\def\pdfending{\ifx\pdfoutput\undefined% 
  _vector.eps% 
  \else%
  _vector%
  \fi}
\newcommand{\pdfinput}[2]{\includegraphics[width=#1]{#2\pdfending}}

% example call \imagw{8cm}{bla.jpg}{bla}{caption abl}
\newcommand{\imagw}[4]{
  \begin{figure}[!hbt]
    \centering
    \includegraphics[width=#1]{#2}
    \caption{#4}
    \label{fig:#3}
  \end{figure}
}

\def\jpgending{\ifx\pdfoutput\undefined% 
  .eps% 
  \else%
  %
  \fi}
% use like this \jpginput{8cm}{imagefile}{caption ...  make sure all
% characters until the opening brace for the caption are on one line
\newcommand{\jpginput}[3]{\imagw{#1}{#2\jpgending}{#2}{#3}}

% this is for plots that are generated by gnuplot
\newcommand{\gnuplotinput}[2]{\begin{figure}[!hbt]%
    \centering%
    \includegraphics{#1_gnuplot}%
    \caption{#2}%
    \label{fig:#1}%
  \end{figure}}

\newcommand{\celegans}{\emph{C.~elegans}}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator*{\sinc}{sinc}
\DeclareMathOperator*{\rect}{rect}

% reference to picture
\newcommand{\figref}[1]{\figurename~\ref{#1}}
\title{Light propagation through bent multi-mode fibers} % i don't call make title
\author{Martin Kielhorn}
% short summary at the beginning of a section
\newenvironment{summary}{\begin{quote}\small}{\end{quote}}

\begin{document}
\maketitle
\section{Introduction}
\section{Modes of a multi-mode fiber}
Das elektrische Feld einer rotationssymmetrischen Faser kann dargestellt werden als
\begin{align}
\E(r,\phi,z,t)=\P a \psi(r) e^{i(\omega t-\beta z \pm l \phi)}
\end{align}
mit einem beliebigen konstanten Polarisationsvektor $\P$, der
Ausbreitungskonstante $\beta$, der Amplitude $a$ und der
Drehimpulsquantenzahl $l$.

Das skalare Feld $\psi(r)$ ergibt sich als L\"osung der Differentialgleichung
\begin{align}
\label{eq:bessel-dgl}
\(\bullet_{,r^2} + \bullet_{,r}/r +k_0^2 n^2(r) -\beta^2 -l^2/r^2\)\psi(r) = 0
\end{align}
Ich beschr\"anke mich hier auf Stufenindexfasern mit kleinem
Indexkontrast. Ihre Brechzahlverteilung ist definiert als
\begin{align}
n(r)&=\nco\sqrt{1-2\Delta\theta(r-\rco)} \\
\theta(r)&=\begin{cases}0 &r<0,\\ 1 & r\ge 0\end{cases} \\
\Delta &= \frac{\nco^2-\ncl^2}{2\nco^2}
\end{align}
mit der Stufenfunktion $\Delta(r)$ und dem Profilh\"ohenparameter
$\Delta$. An der Sprungstelle des Brechungsindex m\"ussen sowohl
$\psi$ als auch $\psi_{,r}$ stetig \"ubergehen. F\"ur st\"uckweise konstante Brechzahl $n(r)$ ist Gleichung \eqref{eq:bessel-dgl} die Besselsche Differentialgleichung und hat die L\"osung
\begin{align}
  R&=r/\rco\\
  \psi(R)&=N\begin{cases}
  J_l(uR)/J_l(u), & 0\le R\le 1\\
  K_l(wR)/K_l(w), & 1<R<\infty 
  \end{cases}\label{eq:psi}\\
  u &= \rco k_0 \sqrt{\nco^2-\neff^2} \\
  w &= \rco k_0 \sqrt{\neff^2-\ncl^2} 
\end{align}
Die Terme im radialen Feld in Gleichung \eqref{eq:psi} sind so
skaliert, dass $\psi$ auf dem Rand $r=\rco$ stetig ist. Die Bedingung,
dass auch die Ableitung $\psi_{,r}$ am \"Ubergang vom Kern zum Mantel
stetig ist liefert die Eigenwertgleichung, oder charakteristische
Gleichung, zur Bestimmung des Modenparameters $u$
\begin{align}
  u\frac{J_{l+1}(u)}{J_l(u)}&=w\frac{K_{l+1}(w)}{K_l(w)}\\
  v^2 &= u^2+w^2\\
  v &= \rco k_0 \sqrt{\nco^2-\ncl^2}
\end{align}
Man kann zeigen, dass diese Gleichung f\"ur $0<v<2.405$ nur eine
einzig L\"osung hat (single-mode). Der Wertebereich f\"ur m\"ogliche
L\"osungen fuer $u$ liegt zwischen 0 und $v$. Bemerkenswert ist, dass
die durch $J_l(u)$ hervorgerufenen Polstellen in der
charakteristischen Gleichung jeweils eine Mode abgrenzen\footnote{Habe
  ich aus Quellcode von H.~Gross erfahren.}. Die Nullstellen der
Besselfunktion k\"onnen leicht mit einer Funktion aus einer
numerischen Bibliothek [Temme1979] bestimmt werden und die Eigenwerte
$u$ k\"onnen in den damit ermittelten Intervallen mit einer
Nullstellensuche, z.B. Brents Methode [Press2007], berechnet werden.

Bei gegebenen Modenparameter $u$ kann die Ausbreitungskonstante $\beta$ errechnet werden
\begin{align}
\beta = \frac{1}{\rco} \sqrt{\frac{v^2}{2\Delta} - u^2}
\end{align}
Die Normierungskonstante $N$ wird so gew\"ahlt, dass die Intensit\"at
$|a|^2$ wird
\begin{align}
  I &= \frac{1}{2}\left|\int_{A_\infty} \(\E\times\H^*\)_z  \textrm{d}A \right| = |a|^2
\end{align}
Da der Indexkontrast klein ist ($\Delta \ll 1$), k\"onnen longitudinale Feldkomponenten vernachl\"assigt werden und es gilt
\begin{align}
  \H(r,\phi,z,t) &= \frac{1}{\mu_0 \omega} \k \times \E, \quad\textrm{with}\ \k = \beta \e_z
\end{align}
Damit ist die Normierungskonstante 
\begin{align}
  N \propto \frac{v^2}{2 u^2} \frac{K_{l-1}(w)K_{l+1}(w)}{K_l^2(w)}
\end{align}

\begin{figure}[hbtp]
  \centering
  \svginput{1}{modes}
  \caption{Modenfelder f\"ur $v=30$ in einer Matrix mit radialer
    Modenzahl $m$ und Drehimpulsquantenzahl $l$. Weiterhin ist auch
    ein Index eingetragen, der alle Moden ausgehend von der Grundmode
    linear indiziert.}
  \label{fig:fields}
\end{figure}
\section{Vorgehensweise zur Berechnung der Modenfelder}
Um die Feldverteilung der einzelnen Moden auszurechnen, kann man
einige Zwischenergebnisse wiederverwenden.

Folgende Funktionen und ihre Ableitungen kann man tabellieren und
sp\"ater mit Spline-Interpolation auswerten um 2D Felder
radialsymmetrisch zu f\"ullen: $\cos(l\phi)$ und $\sin(l\phi)$ mit
$\phi\in[0,2\pi)$ und $l\in[0,\lmax]$. Die maximale Anzahl
  Oszillationen auf dem Kernrand h\"angt von $\lmax$ ab. Dies
  definiert eine Grenze f\"ur die Pixelgr\"osse des Feldes.

Der maximale Wert f\"ur $u$ ist $v$, also reicht f\"ur die
Feldberechnung im Kern $J_l(x)$ mit $x\in[0,v]$ und $l\in[0,\lmax]$.
Die Anzahl der radialen Oszillationen ist maximal f\"ur $J_0(v)$. Dies
liefert eine weitere Grenze f\"ur die Pixelgr\"osse des Feldes.

Die Argumente f\"ur die Funktion $K_l$ erstrecken sich von $w$ nach
unendlich. Das kleinste $w$ ist $\sqrt{v^2-\umax^2}$. Dieser Wert kann
meineserachtens null werden. Verglichen mit $J_l$ sieht $K_l$ sehr
langweilig aus. M\"oglicherweise ist es hilfreich, $K_l(x)/exp(x)$ zu
tabellieren aber die Feldstaerke gef\"uhrter Moden in von uns
betrachteten Multi-mode Fasern faellt ausserhalb des Kernradius
schnell ab und der Einfluss auf Kopplungskonstanten ist
vernachlaessigbar.

Um die Eigenwerte als lineare Sequenz aufzufassen benutzt H.~Gross das
Indexschema, dass durch die roten Zahlen im Mosaik der Modenfelder
angedeutet ist. F\"ur jedes $l$ wird die Anzahl der radialen Moden
$\mmax(l)$ gespeichert und der laufende Index $j$ kann erzeugt werden
durch
\begin{align}
  j &= \begin{cases}
    m & l=0\\
    m+\mmax(0) & l=1\\
    m+\mmax(0)+\mmax(1) & l=1\\
    m+\mmax(0)+ 2\sum_{k=1}^l \mmax(k) & l>1 \\
    m+\mmax(0)+ 2\(\sum_{k=1}^{|l|} \mmax(k)\) + \mmax(|l|) & l<-1
\end{cases}
\end{align}

\section{Kopplung zweier gerader Faserstuecken}
[1989Hill]
\begin{align}
  F_{j(l,m)}(r,\phi) &= \psi(r) 
  \begin{cases}
    \cos(l \phi) & l>0\\  
    \sin(l \phi) & l<0
  \end{cases} \\
  \delta L &= R_b \sin\alpha\\
  c_{nm}&=\int\!\!\!\int\! F_n(x,y)F_m(x,y) e^{ik_0\alpha x} \textrm{d}x \textrm{d}y
\end{align}
\begin{figure}[hbtp]
  \centering
  \includegraphics[width=.7\columnwidth]{bla-coef}
  \includegraphics[width=.7\columnwidth]{bla-coef-phase}
  \caption{Kopplungskonstanten zwischen Moden f\"ur $v=32$ oben
    Absolutbetrag, unten Phase. $\lambda=\unit[500]{nm}$, wedge angle
    $\alpha=\unit[2]{mrad}$.}
  \label{fig:coef}
\end{figure}

\section{Propagation entlang der Faser}
\begin{align}
E_{j(l,m)}(r,\phi,z) = \psi_m(r)e^{-\beta_j z+ l\phi}
\end{align}

\section{Einkopplung in die Faser}
incident beam is tilted towards fiber axis
and fresnel reflection 
[snyder]
\begin{align}
n_i \sin(\theta_i) &= \nco \sin(\theta_z)\\
\E_t(\theta_z) &= \frac{2 n_i}{\nco+n_i} \E_i(\theta_i)
\end{align}

\end{document}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% eval: (reftex-mode)
%%% eval: (flyspell-mode)
%%% End: 
